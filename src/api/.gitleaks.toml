# Gitleaks configuration for secret detection

[extend]
# Extend default configuration
useDefault = true

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)api[_-]?key[_-]?=?['"s]?[0-9a-zA-Z\-_]{16,}'''
tags = ["key", "API"]

[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[A-Za-z0-9_-]*\.eyJ[A-Za-z0-9_-]*\.?[A-Za-z0-9_.+/=\-]*'''
tags = ["jwt", "token"]

[[rules]]
id = "database-url"
description = "Database Connection String"
regex = '''(?i)(postgres|mysql|mongodb)://[^@\s]+:[^@\s]+@[^@\s]+'''
tags = ["database", "connection"]

[[rules]]
id = "redis-url"
description = "Redis Connection String"
regex = '''redis://[^@\s]*:[^@\s]*@[^@\s]+'''
tags = ["redis", "connection"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws", "key"]

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Key"
regex = '''(?i)aws[_-]?secret[_-]?access[_-]?key[_-]?=?['"s]?[0-9a-zA-Z/+=]{40}'''
tags = ["aws", "secret"]

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN (RSA |EC |OPENSSH |DSA )?PRIVATE KEY-----'''
tags = ["private", "key"]

[[rules]]
id = "basic-auth"
description = "Basic Auth Credentials"
regex = '''(?i)authorization:\s*basic\s+[a-zA-Z0-9+/=]+'''
tags = ["auth", "basic"]

# Allowlist patterns
[[allowlist]]
description = "Test fixtures and examples"
regexes = [
    '''test[_-]?key''',
    '''example[_-]?key''',
    '''fake[_-]?key''',
    '''mock[_-]?key''',
    '''dummy[_-]?key''',
    '''placeholder''',
    '''your[_-]?key[_-]?here''',
    '''changeme''',
    '''secret[_-]?value''',
]

[[allowlist]]
description = "Environment variable examples"
files = [
    '''.env.example''',
    '''.env.template''',
    '''README.md''',
    '''EXAMPLE.md''',
]

[[allowlist]]
description = "Test files"
paths = [
    '''test/''',
    '''tests/''',
    '''*_test.py''',
    '''test_*.py''',
]

# File patterns to ignore
[allowlist.files]
".git" = "ignore git directory"
"node_modules" = "ignore node modules"
"*.lock" = "ignore lock files"
"*.log" = "ignore log files"