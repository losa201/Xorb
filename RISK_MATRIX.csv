File_Path,Language,Risk_Level,CWE_ID,CWE_Name,Description,Code_Snippet,Line_Range,Severity,CVSS_Score,Remediation_Priority,Component_Type,Confidence_Level
src/api/app/main.py,Python,HIGH,CWE-209,Improper Error Information Disclosure,Global exception handler exposes internal error details in responses,logger.error(f\"Internal server error: {exc}\"),306-316,HIGH,7.5,HIGH,API_Core,95%
src/api/app/main.py,Python,MEDIUM,CWE-693,Protection Mechanism Failure,CORS allows wildcard origins in production,allow_origins=[...\"https://*.xorb-security.com\"],143,MEDIUM,5.3,MEDIUM,API_Core,90%
src/api/app/main.py,Python,MEDIUM,CWE-200,Exposure of Sensitive Information,API documentation and health endpoints expose system information,\"features\": [\"penetration_testing\"...],328-361,MEDIUM,4.2,LOW,API_Core,85%
src/api/app/security/ptaas_security.py,Python,HIGH,CWE-327,Use of a Broken or Risky Cryptographic Algorithm,Session tokens use SHA256 without proper salt/iterations,hashlib.sha256(token_bytes).hexdigest(),329,HIGH,6.8,HIGH,Security_Core,90%
src/api/app/security/ptaas_security.py,Python,CRITICAL,CWE-78,OS Command Injection,Direct subprocess execution with user-controlled host parameter,socket.gethostbyname(host),145,CRITICAL,9.1,CRITICAL,Security_Core,95%
src/api/app/security/ptaas_security.py,Python,HIGH,CWE-284,Improper Access Control,Network validation bypasses restricted networks with elevated permissions,if not user_context.get(\"elevated_permissions\"... return False,108-109,HIGH,7.2,HIGH,Security_Core,85%
src/api/app/services/ptaas_scanner_service.py,Python,CRITICAL,CWE-78,OS Command Injection,Multiple subprocess calls with user-controlled input,subprocess.exec(*cmd...) with target.host,384-388,CRITICAL,9.3,CRITICAL,Security_Scanner,98%
src/api/app/services/ptaas_scanner_service.py,Python,HIGH,CWE-117,Improper Output Neutralization for Logs,Scanner output directly logged without sanitization,logger.info(f\"Detected scanner: {scanner_name}\"),164,HIGH,6.5,MEDIUM,Security_Scanner,80%
src/api/app/services/ptaas_scanner_service.py,Python,MEDIUM,CWE-400,Uncontrolled Resource Consumption,No timeout limits on scanner execution,timeout=nmap_config.timeout with user control,392,MEDIUM,5.8,MEDIUM,Security_Scanner,85%
src/api/app/routers/ptaas.py,Python,MEDIUM,CWE-200,Exposure of Sensitive Information,Session status endpoint exposes internal scan details,return ScanSessionResponse(**session_status),160,MEDIUM,4.8,LOW,API_Router,75%
src/api/app/routers/ptaas.py,Python,LOW,CWE-209,Information Exposure Through Error Messages,Generic error handling may expose stack traces,raise HTTPException(status_code=500...,136-137,LOW,3.2,LOW,API_Router,70%
src/api/app/middleware/production_security.py,Python,HIGH,CWE-362,Concurrent Execution using Shared Resource,Redis rate limiting has race condition,pipe.incr(rate_key) without atomic check,785-788,HIGH,6.9,HIGH,Security_Middleware,85%
src/api/app/middleware/production_security.py,Python,MEDIUM,CWE-20,Improper Input Validation,IP header validation insufficient for proxy attacks,request.headers.get(header) without validation,648-657,MEDIUM,5.4,MEDIUM,Security_Middleware,80%
src/api/app/middleware/production_security.py,Python,HIGH,CWE-326,Inadequate Encryption Strength,Security headers allow unsafe-inline CSP directive,Content-Security-Policy with unsafe-inline,696,HIGH,6.3,MEDIUM,Security_Middleware,90%
src/api/app/container.py,Python,CRITICAL,CWE-798,Use of Hard-coded Credentials,Default secret key used in production environment,secret_key: os.getenv('SECRET_KEY'... 'default_secret_key'),43,CRITICAL,9.8,CRITICAL,DI_Container,95%
src/api/app/container.py,Python,HIGH,CWE-209,Information Exposure Through Error Messages,Service registration errors expose internal implementation,if callable(implementation): implementation(),147-148,HIGH,6.4,MEDIUM,DI_Container,80%
src/api/app/container.py,Python,MEDIUM,CWE-250,Execution with Unnecessary Privileges,In-memory repositories used for production by default,self.register_singleton(UserRepository... InMemoryUserRepository),58,MEDIUM,5.7,LOW,DI_Container,85%
src/api/app/middleware/tenant_context.py,Python,HIGH,CWE-89,SQL Injection,Direct SQL execution with user-controlled tenant_id,SELECT set_config('app.tenant_id'... str(tenant_id)),74-75,HIGH,8.2,HIGH,Tenant_Middleware,90%
src/api/app/middleware/tenant_context.py,Python,MEDIUM,CWE-755,Improper Handling of Exceptional Conditions,Database errors silently ignored in tenant context,except Exception as e: logger.error... pass,80-82,MEDIUM,4.9,LOW,Tenant_Middleware,75%
src/api/app/middleware/rate_limiting.py,Python,HIGH,CWE-362,Race Condition,Redis operations not atomic in rate limiting,lua_script execution without proper locking,98-107,HIGH,7.1,HIGH,Rate_Limiting,85%
src/api/app/middleware/rate_limiting.py,Python,MEDIUM,CWE-400,Resource Exhaustion,No upper bounds on rate limit configuration,self.config.requests_per_minute * 2,200,MEDIUM,5.2,MEDIUM,Rate_Limiting,80%
src/api/app/infrastructure/database.py,Python,HIGH,CWE-78,OS Command Injection,Database URL construction without validation,postgresql+asyncpg://xorb:changeme@localhost,43,HIGH,7.8,HIGH,Database_Core,95%
src/api/app/infrastructure/database.py,Python,MEDIUM,CWE-200,Information Exposure,Database credentials exposed in configuration,changeme password in default URL,43,MEDIUM,5.5,MEDIUM,Database_Core,90%
src/api/app/infrastructure/database.py,Python,HIGH,CWE-89,SQL Injection,Extension creation without input validation,CREATE EXTENSION IF NOT EXISTS vector,87,HIGH,6.9,MEDIUM,Database_Core,85%
src/api/app/services/interfaces.py,Python,LOW,CWE-710,Improper Adherence to Coding Standards,Abstract methods return Any type compromising type safety,async def authenticate_user... -> Any,21,LOW,3.1,LOW,Service_Interface,70%
src/api/app/domain/exceptions.py,Python,MEDIUM,CWE-209,Information Exposure Through Error Messages,Exception hierarchy may leak internal implementation details,class ValidationError(DomainException),11,MEDIUM,4.3,LOW,Domain_Core,75%
src/api/app/middleware/error_handling.py,Python,HIGH,CWE-209,Information Exposure Through Error Messages,Debug mode exposes stack traces in production,if self.debug: error_detail.details[\"traceback\"],337-338,HIGH,6.7,MEDIUM,Error_Middleware,85%
src/api/app/middleware/error_handling.py,Python,MEDIUM,CWE-755,Improper Handling of Exceptional Conditions,Fail-open error handling may bypass security,return True... \"rate_limiter_unavailable\",123,MEDIUM,5.8,MEDIUM,Error_Middleware,80%
src/api/app/middleware/audit_logging.py,Python,HIGH,CWE-532,Information Exposure Through Log Files,Sensitive request data logged without proper redaction,details[\"request_body\"] = self._redact_sensitive_data(body),448,HIGH,6.2,MEDIUM,Audit_Middleware,85%
src/api/app/middleware/audit_logging.py,Python,MEDIUM,CWE-400,Resource Exhaustion,Unlimited audit log storage in Redis,await self.redis_client.lpush(audit_key... json.dumps),148,MEDIUM,5.4,MEDIUM,Audit_Middleware,80%
src/api/app/auth/models.py,Python,MEDIUM,CWE-269,Improper Privilege Management,SUPER_ADMIN role has unrestricted access to all permissions,Role.SUPER_ADMIN: set(Permission),45,MEDIUM,6.1,MEDIUM,Auth_Model,85%
src/api/app/auth/dependencies.py,Python,HIGH,CWE-287,Improper Authentication,Token validation errors silently return None,except Exception: return None,55-56,HIGH,7.3,HIGH,Auth_Dependencies,90%
src/api/app/auth/dependencies.py,Python,MEDIUM,CWE-285,Improper Authorization,Permission checking relies on list membership instead of set,set(permissions) - current_user.permissions,79,MEDIUM,4.7,LOW,Auth_Dependencies,75%
src/api/app/infrastructure/cache.py,Python,MEDIUM,CWE-502,Deserialization of Untrusted Data,Pickle deserialization without validation,return pickle.loads(value),27,MEDIUM,8.1,HIGH,Cache_Infrastructure,90%
src/api/app/infrastructure/cache.py,Python,LOW,CWE-755,Improper Handling of Exceptional Conditions,Cache errors silently ignored returning None,except Exception: return None,28-29,LOW,3.8,LOW,Cache_Infrastructure,70%
